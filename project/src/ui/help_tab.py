#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
Вкладка со справкой
"""

from PyQt5.QtWidgets import (QWidget, QVBoxLayout, QHBoxLayout, QLabel, 
                            QFrame, QGridLayout, QSizePolicy, QTextBrowser,
                            QTabWidget)
from PyQt5.QtGui import QFont
from PyQt5.QtCore import Qt

class HelpTab(QWidget):
    """Вкладка со справкой"""
    
    def __init__(self):
        super().__init__()
        self.init_ui()
        
    def init_ui(self):
        """Инициализация пользовательского интерфейса"""
        main_layout = QVBoxLayout(self)
        
        # Заголовок
        header_label = QLabel("Справка")
        header_label.setFont(QFont("Segoe UI", 14, QFont.Bold))
        main_layout.addWidget(header_label)
        
        # Вкладки справки
        help_tabs = QTabWidget()
        
        # Вкладка "Руководство пользователя"
        user_guide_tab = QWidget()
        user_guide_layout = QVBoxLayout(user_guide_tab)
        
        self.user_guide_browser = QTextBrowser()
        self.user_guide_browser.setOpenExternalLinks(True)
        self.user_guide_browser.setHtml(self.get_user_guide_html())
        user_guide_layout.addWidget(self.user_guide_browser)
        
        help_tabs.addTab(user_guide_tab, "Руководство пользователя")
        
        # Вкладка "Часто задаваемые вопросы"
        faq_tab = QWidget()
        faq_layout = QVBoxLayout(faq_tab)
        
        self.faq_browser = QTextBrowser()
        self.faq_browser.setOpenExternalLinks(True)
        self.faq_browser.setHtml(self.get_faq_html())
        faq_layout.addWidget(self.faq_browser)
        
        help_tabs.addTab(faq_tab, "Часто задаваемые вопросы")
        
        # Вкладка "О программе"
        about_tab = QWidget()
        about_layout = QVBoxLayout(about_tab)
        
        self.about_browser = QTextBrowser()
        self.about_browser.setOpenExternalLinks(True)
        self.about_browser.setHtml(self.get_about_html())
        about_layout.addWidget(self.about_browser)
        
        help_tabs.addTab(about_tab, "О программе")
        
        main_layout.addWidget(help_tabs)
        
    def get_user_guide_html(self):
        """Получение HTML-кода руководства пользователя"""
        return """
        <h2>Руководство пользователя PC Hardware Diagnostics AI</h2>
        
        <h3>Содержание</h3>
        <ol>
            <li><a href="#introduction">Введение</a></li>
            <li><a href="#installation">Установка и запуск</a></li>
            <li><a href="#interface">Интерфейс программы</a></li>
            <li><a href="#scanning">Сканирование аппаратного обеспечения</a></li>
            <li><a href="#diagnostics">Диагностика системы</a></li>
            <li><a href="#reports">Работа с отчетами</a></li>
            <li><a href="#settings">Настройка программы</a></li>
            <li><a href="#troubleshooting">Устранение неполадок</a></li>
        </ol>
        
        <h3 id="introduction">1. Введение</h3>
        <p>PC Hardware Diagnostics AI - это программа для автоматического определения и диагностики аппаратного обеспечения компьютера с использованием искусственного интеллекта. Программа позволяет выявлять потенциальные проблемы с оборудованием, анализировать производительность компонентов и получать рекомендации по оптимизации работы системы.</p>
        
        <h3 id="installation">2. Установка и запуск</h3>
        <h4>Системные требования:</h4>
        <ul>
            <li>Операционная система: Windows 10/11, macOS 10.14+, Linux (Ubuntu 18.04+)</li>
            <li>Процессор: Intel Core i3 или AMD Ryzen 3 и выше</li>
            <li>Оперативная память: минимум 4 ГБ</li>
            <li>Свободное место на диске: минимум 500 МБ</li>
            <li>Python 3.8 или выше</li>
        </ul>
        
        <h4>Установка:</h4>
        <ol>
            <li>Скачайте установочный файл с официального сайта или из репозитория.</li>
            <li>Запустите установочный файл и следуйте инструкциям мастера установки.</li>
            <li>После завершения установки программа будет готова к использованию.</li>
        </ol>
        
        <h4>Запуск программы:</h4>
        <p>Запустите программу через ярлык на рабочем столе или в меню "Пуск". При первом запуске программа автоматически выполнит сканирование аппаратного обеспечения.</p>
        
        <h3 id="interface">3. Интерфейс программы</h3>
        <p>Интерфейс программы разделен на несколько вкладок, каждая из которых отвечает за определенный аспект работы с аппаратным обеспечением:</p>
        
        <ul>
            <li><strong>Обзор</strong> - общая информация о системе и состоянии компонентов</li>
            <li><strong>Процессор</strong> - детальная информация о процессоре и его производительности</li>
            <li><strong>Видеокарта</strong> - информация о видеокарте и ее производительности</li>
            <li><strong>Память</strong> - информация об оперативной памяти и ее использовании</li>
            <li><strong>Хранилище</strong> - информация о дисках и их состоянии</li>
            <li><strong>Сеть</strong> - информация о сетевых интерфейсах и подключении</li>
            <li><strong>Диагностика</strong> - инструменты для диагностики системы</li>
            <li><strong>Настройки</strong> - настройки программы</li>
            <li><strong>Справка</strong> - руководство пользователя и дополнительная информация</li>
        </ul>
        
        <h3 id="scanning">4. Сканирование аппаратного обеспечения</h3>
        <p>Сканирование аппаратного обеспечения - это процесс сбора информации о компонентах компьютера. Для запуска сканирования:</p>
        
        <ol>
            <li>Нажмите кнопку "Запустить сканирование" в верхней части главного окна.</li>
            <li>Дождитесь завершения процесса сканирования. Прогресс отображается на индикаторе.</li>
            <li>После завершения сканирования информация о компонентах будет отображена на соответствующих вкладках.</li>
        </ol>
        
        <p>Программа может выполнять сканирование автоматически при запуске или через заданные интервалы времени. Эти параметры можно настроить на вкладке "Настройки".</p>
        
        <h3 id="diagnostics">5. Диагностика системы</h3>
        <p>Диагностика системы - это процесс анализа состояния компонентов и выявления потенциальных проблем. Для запуска диагностики:</p>
        
        <ol>
            <li>Перейдите на вкладку "Диагностика".</li>
            <li>Выберите тип диагностики из выпадающего списка.</li>
            <li>Нажмите кнопку "Запустить диагностику".</li>
            <li>Дождитесь завершения процесса диагностики.</li>
            <li>Результаты диагностики и рекомендации будут отображены на вкладке.</li>
        </ol>
        
        <p>Программа использует искусственный интеллект для анализа данных и выявления проблем. Алгоритмы ИИ обучены на большом количестве данных о различных конфигурациях оборудования и типичных проблемах.</p>
        
        <h3 id="reports">6. Работа с отчетами</h3>
        <p>Программа позволяет сохранять отчеты о состоянии системы для дальнейшего анализа или отправки специалистам. Для работы с отчетами:</p>
        
        <ol>
            <li>В меню "Файл" выберите пункт "Сохранить отчет".</li>
            <li>Выберите место сохранения и формат отчета.</li>
            <li>Нажмите кнопку "Сохранить".</li>
        </ol>
        
        <p>Отчеты могут быть сохранены в форматах HTML, PDF или TXT. Формат по умолчанию и путь для сохранения отчетов можно настроить на вкладке "Настройки".</p>
        
        <h3 id="settings">7. Настройка программы</h3>
        <p>Программа предоставляет широкие возможности для настройки. Для доступа к настройкам перейдите на вкладку "Настройки". Доступны следующие группы настроек:</p>
        
        <ul>
            <li><strong>Настройки сканирования</strong> - параметры автоматического сканирования</li>
            <li><strong>Настройки диагностики</strong> - уровень детализации диагностики и другие параметры</li>
            <li><strong>Настройки интерфейса</strong> - тема оформления и размер шрифта</li>
            <li><strong>Настройки отчетов</strong> - формат отчетов и путь для сохранения</li>
        </ul>
        
        <p>После изменения настроек нажмите кнопку "Сохранить настройки" для применения изменений.</p>
        
        <h3 id="troubleshooting">8. Устранение неполадок</h3>
        <p>Если у вас возникли проблемы с работой программы, попробуйте следующие решения:</p>
        
        <ul>
            <li><strong>Программа не запускается</strong> - убедитесь, что установлены все необходимые зависимости и Python версии 3.8 или выше.</li>
            <li><strong>Ошибка при сканировании</strong> - запустите программу с правами администратора для доступа к информации о системе.</li>
            <li><strong>Неполная информация о компонентах</strong> - некоторые компоненты могут не поддерживать предоставление полной информации через API. Попробуйте использовать альтернативные инструменты для получения информации.</li>
            <li><strong>Программа работает медленно</strong> - уменьшите уровень детализации диагностики в настройках.</li>
        </ul>
        
        <p>Если проблема не решена, обратитесь в службу поддержки или посетите официальный форум программы.</p>
        """
        
    def get_faq_html(self):
        """Получение HTML-кода часто задаваемых вопросов"""
        return """
        <h2>Часто задаваемые вопросы (FAQ)</h2>
        
        <h3>Общие вопросы</h3>
        
        <h4>Что такое PC Hardware Diagnostics AI?</h4>
        <p>PC Hardware Diagnostics AI - это программа для автоматического определения и диагностики аппаратного обеспечения компьютера с использованием искусственного интеллекта. Программа позволяет выявлять потенциальные проблемы с оборудованием, анализировать производительность компонентов и получать рекомендации по оптимизации работы системы.</p>
        
        <h4>Какие операционные системы поддерживаются?</h4>
        <p>Программа поддерживает Windows 10/11, macOS 10.14 и выше, а также Linux (Ubuntu 18.04 и выше). Для других дистрибутивов Linux возможна работа, но не гарантируется полная функциональность.</p>
        
        <h4>Нужно ли подключение к интернету для работы программы?</h4>
        <p>Базовые функции программы работают без подключения к интернету. Однако для получения обновлений, доступа к облачной базе данных проблем и использования некоторых функций ИИ требуется подключение к интернету.</p>
        
        <h3>Установка и запуск</h3>
        
        <h4>Как установить программу?</h4>
        <p>Скачайте установочный файл с официального сайта или из репозитория, запустите его и следуйте инструкциям мастера установки. Также можно установить программу из исходного кода, следуя инструкциям в файле README.md.</p>
        
        <h4>Какие зависимости требуются для работы программы?</h4>
        <p>Программа требует Python 3.8 или выше, а также ряд библиотек, которые устанавливаются автоматически в процессе установки. Полный список зависимостей можно найти в файле requirements.txt.</p>
        
        <h4>Почему программа запрашивает права администратора?</h4>
        <p>Для доступа к некоторой информации о системе и аппаратном обеспечении требуются права администратора. Без этих прав некоторые функции программы могут быть недоступны или работать некорректно.</p>
        
        <h3>Функциональность</h3>
        
        <h4>Как часто следует выполнять сканирование и диагностику?</h4>
        <p>Рекомендуется выполнять полное сканирование и диагностику системы не реже одного раза в месяц, а также после установки нового оборудования или при возникновении проблем с работой компьютера.</p>
        
        <h4>Может ли программа повредить мое оборудование?</h4>
        <p>Нет, программа только считывает информацию о системе и не выполняет никаких операций, которые могли бы повредить оборудование. Все тесты производительности выполняются в безопасных пределах.</p>
        
        <h4>Какие проблемы может выявить программа?</h4>
        <p>Программа может выявить широкий спектр проблем, включая перегрев компонентов, недостаточную производительность, проблемы с драйверами, износ дисков, проблемы с памятью, сетевые проблемы и многое другое.</p>
        
        <h4>Насколько точна диагностика с использованием ИИ?</h4>
        <p>Точность диагностики зависит от многих факторов, включая доступность информации о компонентах и качество обучения моделей ИИ. В большинстве случаев точность диагностики составляет более 90%, но некоторые специфические проблемы могут быть не выявлены или диагностированы неверно.</p>
        
        <h3>Устранение неполадок</h3>
        
        <h4>Программа не видит некоторые компоненты моего компьютера. Что делать?</h4>
        <p>Убедитесь, что программа запущена с правами администратора. Если проблема не решена, проверьте, установлены ли последние драйверы для компонентов. Некоторые устаревшие или экзотические компоненты могут не поддерживаться программой.</p>
        
        <h4>Почему результаты диагностики отличаются от других программ?</h4>
        <p>Разные программы диагностики могут использовать различные методы и критерии для оценки состояния компонентов. Кроме того, наша программа использует ИИ для анализа данных, что может давать более точные результаты в некоторых случаях.</p>
        
        <h4>Программа показывает ошибку при запуске диагностики. Что делать?</h4>
        <p>Проверьте журнал ошибок программы для получения более подробной информации о проблеме. Возможно, требуется обновление программы или установка дополнительных зависимостей. Если проблема не решена, обратитесь в службу поддержки.</p>
        
        <h3>Прочее</h3>
        
        <h4>Как обновить программу?</h4>
        <p>Программа автоматически проверяет наличие обновлений при запуске (если включена соответствующая опция в настройках). Также вы можете проверить наличие обновлений вручную через меню "Справка" > "Проверить обновления".</p>
        
        <h4>Где хранятся настройки программы?</h4>
        <p>Настройки программы хранятся в файле config.json в директории программы. Резервные копии настроек создаются автоматически перед каждым изменением.</p>
        
        <h4>Как связаться со службой поддержки?</h4>
        <p>Вы можете связаться со службой поддержки через форму обратной связи на официальном сайте программы или по электронной почте support@diagnosticsai.com.</p>
        """
        
    def get_about_html(self):
        """Получение HTML-кода информации о программе"""
        return """
        <h2>О программе PC Hardware Diagnostics AI</h2>
        
        <p><strong>Версия:</strong> 1.0.0</p>
        <p><strong>Дата выпуска:</strong> 2025</p>
        <p><strong>Разработчик:</strong> DiagnosticsAI</p>
        
        <h3>Описание</h3>
        <p>PC Hardware Diagnostics AI - это программа для автоматического определения и диагностики аппаратного обеспечения компьютера с использованием искусственного интеллекта. Программа позволяет выявлять потенциальные проблемы с оборудованием, анализировать производительность компонентов и получать рекомендации по оптимизации работы системы.</p>
        
        <h3>Основные возможности</h3>
        <ul>
            <li>Автоматическое определение аппаратного обеспечения компьютера</li>
            <li>Анализ состояния и производительности компонентов с помощью ИИ</li>
            <li>Выявление неисправностей и проблем с оборудованием</li>
            <li>Детальный отчет о состоянии системы с рекомендациями</li>
            <li>Отслеживание изменений параметров оборудования во времени</li>
            <li>Интуитивно понятный графический интерфейс пользователя</li>
        </ul>
        
        <h3>Технологии</h3>
        <p>Программа разработана с использованием следующих технологий:</p>
        <ul>
            <li>Python 3.8+</li>
            <li>PyQt5 для графического интерфейса</li>
            <li>DigitalGPT-2 для анализа данных и диагностики</li>
            <li>psutil, py-cpuinfo, GPUtil и другие библиотеки для сбора информации о системе</li>
            <li>Matplotlib и Seaborn для визуализации данных</li>
        </ul>
        
        <h3>Лицензия</h3>
        <p>© 2025 DiagnosticsAI. Все права защищены.</p>
        <p>Программа распространяется под лицензией MIT. Полный текст лицензии доступен в файле LICENSE.</p>
        
        <h3>Благодарности</h3>
        <p>Мы благодарим всех, кто принимал участие в разработке и тестировании программы, а также сообщество разработчиков открытого программного обеспечения за создание библиотек и инструментов, которые были использованы в этом проекте.</p>
        
        <h3>Контакты</h3>
        <p><strong>Веб-сайт:</strong> <a href="https://www.diagnosticsai.com">www.diagnosticsai.com</a></p>
        <p><strong>Электронная почта:</strong> <a href="mailto:info@diagnosticsai.com">info@diagnosticsai.com</a></p>
        <p><strong>Техническая поддержка:</strong> <a href="mailto:support@diagnosticsai.com">support@diagnosticsai.com</a></p>
        """